generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Role {
  id          String     @id @default(cuid())
  key         RoleKey    @unique
  name        String
  description String?
  permissions String[]   @default([])
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  users       UserRole[]

  @@map("roles")
}

model User {
  id                    String                 @id @default(cuid())
  email                 String?                @unique
  emailVerifiedAt       DateTime?
  passwordHash          String?
  name                  String?
  headline              String?
  bio                   String?
  avatarUrl             String?
  coverImageUrl         String?
  defaultRole           RoleKey                @default(STUDENT)
  status                UserStatus             @default(PENDING)
  lastLoginAt           DateTime?
  onboardingState       Json?
  settings              Json?
  createdAt             DateTime               @default(now())
  updatedAt             DateTime               @updatedAt
  accounts              Account[]
  activities            ActivityLog[]
  analyticsEvents       AnalyticsEvent[]
  gradedSubmissions     AssignmentSubmission[] @relation("SubmissionGrader")
  assignmentSubmissions AssignmentSubmission[] @relation("SubmissionAuthor")
  auditLogs             AuditLog[]
  certificates          Certificate[]
  cmsActivities         CmsActivity[]
  media                 Media[]
  cmsVersions           CmsPageVersion[]
  cmsPages              CmsPage[]              @relation("CmsPageAuthor")
  contentVersions       ContentVersion[]
  courseProgress        CourseProgress[]
  courses               Course[]
  enrollments           Enrollment[]
  notes                 LessonNote[]
  lessonProgress        LessonProgress[]
  topicProgress         TopicProgress[]
  subtopicProgress      SubtopicProgress[]
  mentorProfile         MentorProfile?
  notifications         Notification[]
  paymentOrders         PaymentOrder[]
  payments              Payment[]
  sandboxCollaborations SandboxCollaborator[]
  sandboxWorkspaces     SandboxWorkspace[]     @relation("WorkspaceOwner")
  savedItems            SavedItem[]
  sessions              Session[]
  supportTickets        SupportTicket[]
  testimonials          Testimonial[]
  twoFactor             TwoFactor[]
  roles                 UserRole[]

  @@map("users")
}

model UserRole {
  id         String   @id @default(cuid())
  userId     String
  roleId     String
  isPrimary  Boolean  @default(false)
  assignedAt DateTime @default(now())
  role       Role     @relation(fields: [roleId], references: [id], onDelete: Cascade)
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, roleId])
  @@index([roleId])
  @@map("user_roles")
}

model TwoFactor {
  id         String          @id @default(cuid())
  userId     String
  method     TwoFactorMethod
  secret     String?
  emailCode  String?
  phone      String?
  expiresAt  DateTime?
  lastUsedAt DateTime?
  createdAt  DateTime        @default(now())
  user       User            @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("two_factor")
}

model EmailOtp {
  id         String    @id @default(cuid())
  email      String
  codeHash   String
  expiresAt  DateTime
  consumedAt DateTime?
  createdAt  DateTime  @default(now())
  ipAddress  String?

  @@unique([email, codeHash])
  @@index([email])
  @@map("email_otps")
}

model Account {
  id                String   @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  user              User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
  @@index([userId])
  @@map("accounts")
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  createdAt    DateTime @default(now())
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("sessions")
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
  @@map("verification_tokens")
}

model CourseCategory {
  id          String   @id @default(cuid())
  slug        String   @unique
  name        String
  description String?
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  courses     Course[]

  @@map("course_categories")
}

model Course {
  id               String           @id @default(cuid())
  slug             String           @unique
  title            String
  description      String?
  thumbnail        String?
  level            String?
  duration         String?
  price            Float            @default(0)
  status           ContentStatus    @default(DRAFT)
  publishedAt      DateTime?
  scheduledAt      DateTime?
  order            Int              @default(0)
  metadata         Json?
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  categoryId       String?
  instructorId     String?
  assignments      Assignment[]
  certificates     Certificate[]
  courseProgresses CourseProgress[]
  category         CourseCategory?  @relation(fields: [categoryId], references: [id])
  instructor       User?            @relation(fields: [instructorId], references: [id])
  enrollments      Enrollment[]
  lessons          Lesson[]
  modules          Module[]
  resources        CourseResource[]

  @@index([categoryId])
  @@index([status])
  @@index([order])
  @@map("courses")
}

model Module {
  id          String   @id @default(cuid())
  courseId    String
  slug        String
  title       String
  description String?
  order       Int      @default(0)
  metadata    Json?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  lessons     Lesson[]
  course      Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@unique([courseId, slug])
  @@index([courseId])
  @@index([order])
  @@map("modules")
}

model Lesson {
  id               String           @id @default(cuid())
  courseId         String?
  moduleId         String?
  slug             String           @unique
  title            String
  description      String?
  body             String?
  youtubeUrl       String?
  estimatedMinutes Int?
  difficulty       String?
  order            Int              @default(0)
  status           ContentStatus    @default(DRAFT)
  publishedAt      DateTime?
  scheduledAt      DateTime?
  metadata         Json?
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  assignments      Assignment[]
  notes            LessonNote[]
  progress         LessonProgress[]
  quizzes          LessonQuiz[]
  course           Course?          @relation(fields: [courseId], references: [id])
  module           Module?          @relation(fields: [moduleId], references: [id])
  content          LessonContent?
  exercises        LessonExercise[]
  resources        CourseResource[]
  topics           LessonTopic[]

  @@index([courseId])
  @@index([moduleId])
  @@index([status])
  @@index([order])
  @@map("lessons")
}

model LessonTopic {
  id          String   @id @default(cuid())
  lessonId    String
  title       String
  description String?
  order       Int      @default(0)
  estimatedMinutes Int? @default(10)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  lesson      Lesson   @relation(fields: [lessonId], references: [id], onDelete: Cascade)
  subtopics   LessonSubtopic[]
  progress    TopicProgress[]

  @@index([lessonId])
  @@index([order])
  @@map("lesson_topics")
}

model LessonSubtopic {
  id          String   @id @default(cuid())
  topicId     String
  title       String
  description String?
  order       Int      @default(0)
  estimatedMinutes Int? @default(5)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  topic       LessonTopic @relation(fields: [topicId], references: [id], onDelete: Cascade)
  content     SubtopicContent?
  exercises   SubtopicExercise[]
  progress    SubtopicProgress[]

  @@index([topicId])
  @@index([order])
  @@map("lesson_subtopics")
}

model SubtopicContent {
  id          String   @id @default(cuid())
  subtopicId  String   @unique
  type        String   @default("reading") // reading, video, exercise, project
  theory      String?  // Markdown content
  videoUrl    String?
  youtubeId   String?
  duration    String?
  codeExample Json?    // { html, css, js }
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  subtopic    LessonSubtopic @relation(fields: [subtopicId], references: [id], onDelete: Cascade)
  blocks      SubtopicContentBlock[]

  @@map("subtopic_content")
}

model SubtopicContentBlock {
  id                String         @id @default(cuid())
  subtopicContentId String
  type              String         // text, code, image, video, quiz
  content           Json
  order             Int            @default(0)
  createdAt         DateTime       @default(now())
  updatedAt         DateTime       @updatedAt
  subtopicContent   SubtopicContent @relation(fields: [subtopicContentId], references: [id], onDelete: Cascade)

  @@index([subtopicContentId])
  @@map("subtopic_content_blocks")
}

model SubtopicExercise {
  id          String   @id @default(cuid())
  subtopicId  String
  title       String
  description String
  starterCode Json     // { html, css, js }
  solution    Json     // { html, css, js }
  hints       String[] @default([])
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  subtopic    LessonSubtopic @relation(fields: [subtopicId], references: [id], onDelete: Cascade)

  @@index([subtopicId])
  @@map("subtopic_exercises")
}

model TopicProgress {
  id          String    @id @default(cuid())
  userId      String
  topicId     String
  completed   Boolean   @default(false)
  completedAt DateTime?
  timeSpent   Int       @default(0) // in seconds
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  topic       LessonTopic @relation(fields: [topicId], references: [id], onDelete: Cascade)
  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, topicId])
  @@map("topic_progress")
}

model SubtopicProgress {
  id          String    @id @default(cuid())
  userId      String
  subtopicId  String
  completed   Boolean   @default(false)
  completedAt DateTime?
  timeSpent   Int       @default(0) // in seconds
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  subtopic    LessonSubtopic @relation(fields: [subtopicId], references: [id], onDelete: Cascade)
  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, subtopicId])
  @@map("subtopic_progress")
}

model LessonContent {
  id          String   @id @default(cuid())
  lessonId    String   @unique
  type        String   @default("reading") // reading, video, exercise, project
  theory      String?  // Markdown content
  videoUrl    String?
  youtubeId   String?
  duration    String?
  codeExample Json?    // { html, css, js }
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  lesson      Lesson   @relation(fields: [lessonId], references: [id], onDelete: Cascade)
  blocks      ContentBlock[]

  @@map("lesson_content")
}

model LessonExercise {
  id          String   @id @default(cuid())
  lessonId    String
  title       String
  description String
  starterCode Json     // { html, css, js }
  solution    Json     // { html, css, js }
  hints       String[] @default([])
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  lesson      Lesson   @relation(fields: [lessonId], references: [id], onDelete: Cascade)

  @@index([lessonId])
  @@map("lesson_exercises")
}

model ContentBlock {
  id              String         @id @default(cuid())
  lessonContentId String
  type            String         // text, code, image, video, quiz
  content         Json
  order           Int            @default(0)
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  lessonContent   LessonContent  @relation(fields: [lessonContentId], references: [id], onDelete: Cascade)

  @@index([lessonContentId])
  @@map("content_blocks")
}

model CourseResource {
  id          String   @id @default(cuid())
  courseId    String?
  lessonId    String?
  title       String
  description String?
  url         String
  type        String   // pdf, video, link, download
  size        Int?     // in bytes
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  course      Course?  @relation(fields: [courseId], references: [id])
  lesson      Lesson?  @relation(fields: [lessonId], references: [id])

  @@index([courseId])
  @@index([lessonId])
  @@map("course_resources")
}

model RealtimeEvent {
  id        BigInt   @id @default(autoincrement())
  channel   String   @default("default")
  type      String
  entity    String?
  payload   Json?
  createdAt DateTime @default(now()) @map("created_at")

  @@index([createdAt], map: "idx_realtime_events_created_at")
  @@map("realtime_events")
}

model LessonQuiz {
  id        String   @id @default(cuid())
  lessonId  String
  data      Json
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  lesson    Lesson   @relation(fields: [lessonId], references: [id], onDelete: Cascade)

  @@map("lesson_quizzes")
}

model LessonNote {
  id        String   @id @default(cuid())
  lessonId  String
  userId    String
  content   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  lesson    Lesson   @relation(fields: [lessonId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([lessonId])
  @@index([userId])
  @@map("lesson_notes")
}

model Enrollment {
  id          String           @id @default(cuid())
  userId      String
  courseId    String
  status      EnrollmentStatus @default(ACTIVE)
  startedAt   DateTime         @default(now())
  completedAt DateTime?
  expiresAt   DateTime?
  autoRenew   Boolean          @default(false)
  metadata    Json?
  course      Course           @relation(fields: [courseId], references: [id], onDelete: Cascade)
  user        User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, courseId])
  @@map("enrollments")
}

model CourseProgress {
  id                 String   @id @default(cuid())
  userId             String
  courseId           String
  completedLessons   Int      @default(0)
  totalLessons       Int      @default(0)
  progressPercent    Float    @default(0)
  lastViewedLessonId String?
  updatedAt          DateTime @updatedAt
  createdAt          DateTime @default(now())
  course             Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)
  user               User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, courseId])
  @@map("course_progress")
}

model LessonProgress {
  id          String    @id @default(cuid())
  userId      String
  lessonId    String
  completed   Boolean   @default(false)
  completedAt DateTime?
  notesCount  Int       @default(0)
  checkpoints Json?
  lesson      Lesson    @relation(fields: [lessonId], references: [id], onDelete: Cascade)
  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, lessonId])
  @@map("lesson_progress")
}

model Assignment {
  id          String                 @id @default(cuid())
  courseId    String?
  lessonId    String?
  title       String
  description String?
  type        AssignmentType         @default(CODING)
  dueAt       DateTime?
  maxScore    Int?
  metadata    Json?
  createdAt   DateTime               @default(now())
  updatedAt   DateTime               @updatedAt
  submissions AssignmentSubmission[]
  course      Course?                @relation(fields: [courseId], references: [id])
  lesson      Lesson?                @relation(fields: [lessonId], references: [id])

  @@map("assignments")
}

model AssignmentSubmission {
  id           String           @id @default(cuid())
  assignmentId String
  userId       String
  status       SubmissionStatus @default(DRAFT)
  grade        Int?
  feedback     String?
  content      Json?
  submittedAt  DateTime?
  gradedAt     DateTime?
  graderId     String?
  assignment   Assignment       @relation(fields: [assignmentId], references: [id], onDelete: Cascade)
  grader       User?            @relation("SubmissionGrader", fields: [graderId], references: [id])
  user         User             @relation("SubmissionAuthor", fields: [userId], references: [id], onDelete: Cascade)

  @@index([assignmentId])
  @@index([userId])
  @@map("assignment_submissions")
}

model SavedItem {
  id        String      @id @default(cuid())
  userId    String
  itemType  ProductType
  itemId    String
  createdAt DateTime    @default(now())
  metadata  Json?
  user      User        @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, itemType, itemId])
  @@map("saved_items")
}

model Certificate {
  id                String    @id @default(cuid())
  userId            String
  courseId          String
  issuedAt          DateTime  @default(now())
  certificateNumber String    @unique
  metadata          Json?
  expiresAt         DateTime?
  course            Course    @relation(fields: [courseId], references: [id], onDelete: Cascade)
  user              User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("certificates")
}

model Project {
  id          String         @id @default(cuid())
  slug        String         @unique
  title       String
  description String?
  thumbnail   String?
  level       String?
  category    String?
  price       Float          @default(0)
  tools       String[]       @default([])
  includes    String[]       @default([])
  driveUrl    String?
  upiId       String?
  formUrl     String?
  status      ContentStatus  @default(DRAFT)
  publishedAt DateTime?
  scheduledAt DateTime?
  featured    Boolean        @default(false)
  metadata    Json?
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
  assets      ProjectAsset[]

  @@index([status])
  @@index([featured])
  @@map("projects")
}

model ProjectAsset {
  id        String   @id @default(cuid())
  projectId String
  type      String
  url       String?
  size      Int?
  metadata  Json?
  createdAt DateTime @default(now())
  filename  String?
  updatedAt DateTime @updatedAt
  project   Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId])
  @@map("project_assets")
}

model SandboxWorkspace {
  id            String                @id @default(cuid())
  ownerId       String
  title         String
  description   String?
  html          String?
  css           String?
  js            String?
  framework     String?
  visibility    SandboxVisibility     @default(PRIVATE)
  shareToken    String?
  lockedUntil   DateTime?
  metadata      Json?
  createdAt     DateTime              @default(now())
  updatedAt     DateTime              @updatedAt
  collaborators SandboxCollaborator[]
  owner         User                  @relation("WorkspaceOwner", fields: [ownerId], references: [id], onDelete: Cascade)

  @@index([ownerId])
  @@map("sandbox_workspaces")
}

model SandboxCollaborator {
  id          String           @id @default(cuid())
  workspaceId String
  userId      String
  invitedAt   DateTime         @default(now())
  acceptedAt  DateTime?
  role        RoleKey          @default(STUDENT)
  user        User             @relation(fields: [userId], references: [id], onDelete: Cascade)
  workspace   SandboxWorkspace @relation(fields: [workspaceId], references: [id], onDelete: Cascade)

  @@unique([workspaceId, userId])
  @@map("sandbox_collaborators")
}

model PaymentOrder {
  id            String        @id @default(cuid())
  orderId       String        @unique
  userId        String
  productType   ProductType
  productId     String
  amountInPaise Int
  currency      String        @default("INR")
  status        PaymentStatus @default(CREATED)
  receipt       String?
  notes         Json?
  createdAt     DateTime      @default(now())
  expiresAt     DateTime?
  user          User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  payments      Payment[]

  @@index([userId])
  @@map("payment_orders")
}

model Payment {
  id            String        @id @default(cuid())
  orderId       String
  userId        String
  paymentId     String?       @unique
  signature     String?
  status        PaymentStatus @default(AUTHORIZED)
  paidAt        DateTime?
  amountInPaise Int
  method        String?
  email         String?
  contact       String?
  data          Json?
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  order         PaymentOrder  @relation(fields: [orderId], references: [id], onDelete: Cascade)
  user          User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([orderId])
  @@index([userId])
  @@map("payments")
}

model PaymentWebhook {
  id          String    @id @default(cuid())
  eventId     String    @unique
  payload     Json
  processed   Boolean   @default(false)
  processedAt DateTime?
  createdAt   DateTime  @default(now())

  @@map("payment_webhooks")
}

model CmsPage {
  id          String           @id @default(cuid())
  slug        String           @unique
  title       String
  description String?
  status      CmsStatus        @default(DRAFT)
  isPublished Boolean          @default(false)
  publishedAt DateTime?
  seo         Json?
  ogImageUrl  String?
  metadata    Json?
  blocks      Json?
  authorId    String?
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
  activities  CmsActivity[]
  versions    CmsPageVersion[]
  author      User?            @relation("CmsPageAuthor", fields: [authorId], references: [id])

  @@map("cms_pages")
}

model CmsPageVersion {
  id            String           @id @default(cuid())
  pageId        String
  version       Int
  status        CmsStatus
  data          Json
  createdBy     String?
  action        CmsPublishAction
  createdAt     DateTime         @default(now())
  createdByUser User?            @relation(fields: [createdBy], references: [id])
  page          CmsPage          @relation(fields: [pageId], references: [id], onDelete: Cascade)

  @@map("cms_page_versions")
}

model CmsActivity {
  id        String           @id @default(cuid())
  pageId    String
  userId    String?
  action    CmsPublishAction
  notes     String?
  createdAt DateTime         @default(now())
  page      CmsPage          @relation(fields: [pageId], references: [id], onDelete: Cascade)
  user      User?            @relation(fields: [userId], references: [id])

  @@map("cms_activity")
}

model Media {
  id           String   @id @default(cuid())
  userId       String?
  originalName String
  mimeType     String
  size         Int
  url          String
  thumbnailUrl String?
  alt          String?
  metadata     Json?
  createdAt    DateTime @default(now())
  filename     String
  user         User?    @relation(fields: [userId], references: [id])

  @@map("cms_media")
}

model Setting {
  id        String   @id @default(cuid())
  key       String   @unique
  value     Json
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("settings")
}

model Testimonial {
  id        String    @id @default(cuid())
  userId    String?
  name      String
  role      String?
  quote     String
  avatarUrl String?
  highlight String?
  rating    Int       @default(5)
  order     Int       @default(0)
  status    CmsStatus @default(PUBLISHED)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  user      User?     @relation(fields: [userId], references: [id])

  @@map("testimonials")
}

model MentorProfile {
  id           String   @id @default(cuid())
  userId       String   @unique
  bio          String?
  expertise    String[] @default([])
  availability Json?
  ratePerHour  Int?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("mentor_profiles")
}

model AuditLog {
  id          String       @id @default(cuid())
  userId      String?
  metadata    Json?
  ipAddress   String?
  userAgent   String?
  createdAt   DateTime     @default(now())
  contentId   String?
  contentType String?
  details     Json?
  action      ActivityType
  user        User?        @relation(fields: [userId], references: [id])

  @@map("audit_logs")
}

model ActivityLog {
  id        String       @id @default(cuid())
  userId    String?
  type      ActivityType
  message   String?
  data      Json?
  createdAt DateTime     @default(now())
  user      User?        @relation(fields: [userId], references: [id])

  @@map("activity_logs")
}

model AnalyticsEvent {
  id          String   @id @default(cuid())
  userId      String?
  sessionId   String?
  name        String
  contentType String?
  contentId   String?
  metadata    Json?
  createdAt   DateTime @default(now())
  user        User?    @relation(fields: [userId], references: [id])

  @@map("analytics_events")
}

model Notification {
  id        String    @id @default(cuid())
  userId    String
  title     String
  body      String
  actionUrl String?
  readAt    DateTime?
  createdAt DateTime  @default(now())
  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("notifications")
}

model SupportTicket {
  id          String   @id @default(cuid())
  userId      String
  subject     String
  description String
  status      String   @default("OPEN")
  metadata    Json?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("support_tickets")
}

model ContentVersion {
  id            String      @id @default(cuid())
  contentType   ContentType
  contentId     String
  version       Int
  data          Json
  changeNote    String?
  createdBy     String?
  createdAt     DateTime    @default(now())
  createdByUser User?       @relation(fields: [createdBy], references: [id])

  @@map("content_versions")
}

enum RoleKey {
  STUDENT
  MENTOR
  ADMIN
}

enum UserStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
  PENDING
}

enum TwoFactorMethod {
  EMAIL
  AUTH_APP
  SMS
}

enum EnrollmentStatus {
  ACTIVE
  COMPLETED
  CANCELLED
  REFUNDED
  PAST_DUE
}

enum ContentStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
  SCHEDULED
}

enum ContentType {
  COURSE
  LESSON
  PROJECT
  FAQ
  TESTIMONIAL
  SANDBOX_TEMPLATE
}

enum AuditAction {
  CREATE
  UPDATE
  DELETE
  PUBLISH
  UNPUBLISH
  ARCHIVE
  RESTORE
  LOGIN
  LOGOUT
  PERMISSION_CHANGE
}

enum ContentVisibility {
  PUBLIC
  ENROLLED_ONLY
  PREMIUM
}

enum AssignmentType {
  CODING
  QUIZ
  PROJECT
  ESSAY
}

enum SubmissionStatus {
  DRAFT
  SUBMITTED
  REVIEWED
  REVISION_REQUIRED
}

enum ProductType {
  COURSE
  PROJECT
  SANDBOX_UNLOCK
  SUBSCRIPTION
}

enum PaymentStatus {
  CREATED
  AUTHORIZED
  CAPTURED
  FAILED
  REFUNDED
}

enum CmsStatus {
  DRAFT
  REVIEW
  PUBLISHED
  ARCHIVED
}

enum CmsPublishAction {
  CREATE
  UPDATE
  PUBLISH
  UNPUBLISH
}

enum SandboxVisibility {
  PRIVATE
  UNLISTED
  PUBLIC
}

enum ActivityType {
  SIGN_IN
  SIGN_OUT
  COURSE_PROGRESS
  LESSON_COMPLETED
  PAYMENT
  CERTIFICATE_ISSUED
  CONTENT_EDIT
  ROLE_CHANGE
}
