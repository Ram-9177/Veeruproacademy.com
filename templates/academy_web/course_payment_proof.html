{% extends 'academy_web/base.html' %}
{% load i18n %}

{% block title %}Submit Payment Proof - {{ course.title }} - Veeru's Pro Academy{% endblock %}

{% block content %}
<section class="py-12 lg:py-16 bg-gray-50 dark:bg-dark-900 min-h-screen">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Breadcrumb -->
    <nav class="flex items-center space-x-2 text-gray-500 dark:text-gray-400 text-sm mb-8">
      <a href="{% url 'academy_web:home' %}" class="hover:text-brand-orange transition">Home</a>
      <i class="fas fa-chevron-right text-xs"></i>
      <a href="{% url 'academy_web:course_list' %}" class="hover:text-brand-orange transition">Courses</a>
      <i class="fas fa-chevron-right text-xs"></i>
      <a href="{% url 'academy_web:course_detail' course.slug %}" class="hover:text-brand-orange transition">{{ course.title }}</a>
      <i class="fas fa-chevron-right text-xs"></i>
      <span class="text-gray-900 dark:text-white">Payment</span>
    </nav>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Main Content -->
      <div class="lg:col-span-2">
        <div class="bg-white dark:bg-dark-800 rounded-2xl border border-gray-100 dark:border-dark-700 p-8">
          <h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">Complete Your Enrollment</h1>
          <p class="text-gray-600 dark:text-gray-400 mb-8">Submit your payment proof to access the course</p>

          <!-- Payment Instructions -->
          <div class="bg-brand-orange/10 rounded-xl p-6 mb-8">
            <h3 class="font-semibold text-brand-orange mb-4 flex items-center">
              <i class="fas fa-info-circle mr-2"></i>Payment Instructions
            </h3>
            <ol class="space-y-3 text-gray-700 dark:text-gray-300">
              <li class="flex items-start">
                <span class="w-6 h-6 bg-brand-orange text-white rounded-full flex items-center justify-center text-sm font-bold mr-3 flex-shrink-0">1</span>
                <span>Make a payment of <strong class="text-brand-orange">₹{{ course.price|floatformat:0 }}</strong> using UPI, Bank Transfer, or any preferred method</span>
              </li>
              <li class="flex items-start">
                <span class="w-6 h-6 bg-brand-orange text-white rounded-full flex items-center justify-center text-sm font-bold mr-3 flex-shrink-0">2</span>
                <span>Take a screenshot of your payment confirmation</span>
              </li>
              <li class="flex items-start">
                <span class="w-6 h-6 bg-brand-orange text-white rounded-full flex items-center justify-center text-sm font-bold mr-3 flex-shrink-0">3</span>
                <span>Upload the screenshot below along with your transaction ID</span>
              </li>
              <li class="flex items-start">
                <span class="w-6 h-6 bg-brand-orange text-white rounded-full flex items-center justify-center text-sm font-bold mr-3 flex-shrink-0">4</span>
                <span>We'll verify and grant access within 24 hours</span>
              </li>
            </ol>
          </div>

          <!-- Payment Form -->
          <form method="post" enctype="multipart/form-data" class="space-y-6">
            {% csrf_token %}
            
            <div>
              <label for="transaction_id" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                Transaction ID / UTR Number <span class="text-red-500">*</span>
              </label>
              <input type="text" id="transaction_id" name="transaction_id" required
                     class="w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-dark-600 bg-white dark:bg-dark-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-brand-orange focus:border-transparent"
                     placeholder="Enter your transaction ID">
            </div>

            <div>
              <label for="screenshot" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                Payment Screenshot <span class="text-red-500">*</span>
              </label>
              <div class="border-2 border-dashed border-gray-200 dark:border-dark-600 rounded-xl p-8 text-center hover:border-brand-orange transition cursor-pointer" onclick="document.getElementById('screenshot').click()">
                <i class="fas fa-cloud-upload-alt text-gray-400 dark:text-gray-500 text-4xl mb-4"></i>
                <p class="text-gray-600 dark:text-gray-400 mb-2">Click to upload or drag and drop</p>
                <p class="text-gray-400 dark:text-gray-500 text-sm">PNG, JPG up to 5MB</p>
                <input type="file" id="screenshot" name="screenshot" accept="image/*" required class="hidden">
              </div>
              <p id="fileName" class="mt-2 text-sm text-brand-orange hidden"></p>
            </div>

            <div>
              <label for="notes" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                Additional Notes (Optional)
              </label>
              <textarea id="notes" name="notes" rows="3"
                        class="w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-dark-600 bg-white dark:bg-dark-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-brand-orange focus:border-transparent resize-none"
                        placeholder="Any additional information about your payment"></textarea>
            </div>

            <button type="submit" class="w-full bg-brand-orange text-white py-4 rounded-xl font-semibold text-lg hover:bg-brand-blue transition shadow-lg">
              <i class="fas fa-paper-plane mr-2"></i>Submit Payment Proof
            </button>
          </form>
        </div>
      </div>

      <!-- Course Card Sidebar -->
      <div class="lg:col-span-1">
        <div class="bg-white dark:bg-dark-800 rounded-2xl border border-gray-100 dark:border-dark-700 p-6 sticky top-24">
          <h3 class="font-semibold text-gray-900 dark:text-white mb-4">Course Summary</h3>
          
          <div class="bg-brand-orange rounded-xl h-32 flex items-center justify-center mb-4">
            {% if course.thumbnail %}
              <img src="{{ course.thumbnail }}" alt="{{ course.title }}" class="w-full h-full object-cover rounded-xl">
            {% else %}
              <i class="fas fa-book-open text-white/30 text-4xl"></i>
            {% endif %}
          </div>
          
          <h4 class="font-bold text-gray-900 dark:text-white mb-2">{{ course.title }}</h4>
          <p class="text-gray-600 dark:text-gray-400 text-sm mb-4">{{ course.description|truncatewords:20 }}</p>
          
          <div class="border-t border-gray-100 dark:border-dark-700 pt-4">
            <div class="flex justify-between items-center">
              <span class="text-gray-600 dark:text-gray-400">Amount</span>
              <span class="text-2xl font-bold text-brand-orange">₹{{ course.price|floatformat:0 }}</span>
            </div>
          </div>

          <div class="mt-6 p-4 bg-green-50 dark:bg-green-900/20 rounded-xl">
            <div class="flex items-start space-x-3">
              <i class="fas fa-shield-alt text-green-500 mt-1"></i>
              <div>
                <p class="font-medium text-green-700 dark:text-green-400 text-sm">Secure Payment</p>
                <p class="text-green-600 dark:text-green-500 text-xs">Your payment details are safe with us</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
document.getElementById('screenshot').addEventListener('change', function(e) {
  const fileName = e.target.files[0]?.name;
  const fileNameEl = document.getElementById('fileName');
  if (fileName) {
    fileNameEl.textContent = 'Selected: ' + fileName;
    fileNameEl.classList.remove('hidden');
  }
});
</script>
{% endblock %}
