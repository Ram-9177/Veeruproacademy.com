{% extends 'academy_web/base.html' %}
{% load i18n %}

{% block title %}All Courses - Veeru's Pro Academy{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="bg-brand-orange text-white py-16">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center">
      <h1 class="text-4xl lg:text-5xl font-bold mb-4">Explore Our Courses</h1>
      <p class="text-xl text-white/80 max-w-2xl mx-auto mb-8">Choose from our collection of expert-led courses designed to take your skills to the next level</p>
      
      <!-- Search Bar -->
      <div class="max-w-xl mx-auto">
        <div class="relative">
          <input type="text" id="courseSearch" placeholder="Search courses..." class="w-full px-6 py-4 rounded-xl border-2 border-white/20 bg-white/10 text-white placeholder-white/60 focus:outline-none focus:border-white/40 backdrop-blur-sm pr-12" onkeyup="filterCourses()">
          <i class="fas fa-search absolute right-5 top-1/2 -translate-y-1/2 text-white/60"></i>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Filters & Stats Bar -->
<section class="bg-white dark:bg-dark-800 border-b border-gray-100 dark:border-dark-700 py-4 sticky top-0 z-40">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
      <!-- Filter Buttons -->
      <div class="flex flex-wrap items-center gap-2">
        <span class="text-gray-500 dark:text-gray-400 text-sm mr-2">Filter:</span>
        <button onclick="filterByLevel('')" class="filter-btn px-4 py-2 rounded-lg text-sm font-medium bg-brand-orange/10 text-brand-orange transition" data-level="">
          All
        </button>
        <button onclick="filterByLevel('Beginner')" class="filter-btn px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 dark:bg-dark-700 text-gray-600 dark:text-gray-400 hover:bg-brand-orange/10 transition" data-level="Beginner">
          <i class="fas fa-seedling mr-1"></i>Beginner
        </button>
        <button onclick="filterByLevel('Intermediate')" class="filter-btn px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 dark:bg-dark-700 text-gray-600 dark:text-gray-400 hover:bg-brand-orange/10 transition" data-level="Intermediate">
          <i class="fas fa-chart-line mr-1"></i>Intermediate
        </button>
        <button onclick="filterByLevel('Advanced')" class="filter-btn px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 dark:bg-dark-700 text-gray-600 dark:text-gray-400 hover:bg-brand-orange/10 transition" data-level="Advanced">
          <i class="fas fa-rocket mr-1"></i>Advanced
        </button>
        <button onclick="filterByPrice('free')" class="filter-btn px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 dark:bg-dark-700 text-gray-600 dark:text-gray-400 hover:bg-green-100 dark:hover:bg-green-900/30 transition" data-price="free">
          <i class="fas fa-gift mr-1"></i>Free
        </button>
      </div>
      
      <!-- Course Count -->
      <div class="text-gray-600 dark:text-gray-400 text-sm">
        <span id="courseCount">{{ courses|length }}</span> courses available
      </div>
    </div>
  </div>
</section>

<!-- Courses Grid -->
<section class="py-16 bg-gray-50 dark:bg-dark-900">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    {% if courses %}
      <div id="coursesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {% for course in courses %}
          <div class="course-card bg-white dark:bg-dark-800 rounded-2xl overflow-hidden shadow-sm card-hover border border-gray-100 dark:border-dark-700" 
               data-title="{{ course.title|lower }}" 
               data-level="{{ course.level|default:'Beginner' }}" 
               data-price="{{ course.price|default:0 }}"
               data-description="{{ course.description|lower|default:'' }}">
            <!-- Course Thumbnail -->
            <div class="relative h-48 bg-brand-orange">
              {% if course.thumbnail %}
                <img src="{{ course.thumbnail }}" alt="{{ course.title }}" class="w-full h-full object-cover" loading="lazy">
              {% else %}
                <div class="flex items-center justify-center h-full">
                  <i class="fas fa-book-open text-white/30 text-6xl"></i>
                </div>
              {% endif %}
              
              <!-- Price Badge -->
              {% if course.price and course.price > 0 %}
                <span class="absolute top-4 left-4 bg-brand-blue text-white px-4 py-1.5 rounded-full text-sm font-bold shadow-lg">
                  â‚¹{{ course.price|floatformat:0 }}
                </span>
              {% else %}
                <span class="absolute top-4 left-4 bg-green-500 text-white px-4 py-1.5 rounded-full text-sm font-bold shadow-lg">
                  Free
                </span>
              {% endif %}
              
              <!-- Level Badge -->
              {% if course.level %}
                <span class="absolute top-4 right-4 bg-black/50 text-white px-3 py-1 rounded-full text-xs font-medium backdrop-blur-sm">
                  {{ course.level }}
                </span>
              {% endif %}
            </div>
            
            <!-- Course Content -->
            <div class="p-6">
              <!-- Meta Info -->
              <div class="flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 mb-3">
                {% if course.duration %}
                  <span class="flex items-center">
                    <i class="fas fa-clock mr-1.5"></i>{{ course.duration }}
                  </span>
                {% endif %}
                <span class="flex items-center">
                  <i class="fas fa-layer-group mr-1.5"></i>{{ course.modules.count }} Modules
                </span>
              </div>
              
              <!-- Title -->
              <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-3 line-clamp-2">{{ course.title }}</h3>
              
              <!-- Description -->
              <p class="text-gray-600 dark:text-gray-400 mb-4 line-clamp-2">{{ course.description|default:"Start your learning journey with this comprehensive course." }}</p>
              
              <!-- Instructor -->
              {% if course.instructor %}
                <div class="flex items-center gap-2 mb-4 pb-4 border-b border-gray-100 dark:border-dark-700">
                  <div class="w-8 h-8 bg-brand-orange/10 rounded-full flex items-center justify-center">
                    <i class="fas fa-user text-brand-orange text-xs"></i>
                  </div>
                  <span class="text-sm text-gray-600 dark:text-gray-400">{{ course.instructor.name|default:course.instructor.email }}</span>
                </div>
              {% endif %}
              
              <!-- Action Button -->
              <a href="{% url 'academy_web:course_detail' course.slug %}" class="block w-full text-center bg-brand-orange text-white py-3 rounded-xl font-semibold hover:bg-brand-blue transition shadow-lg">
                View Course <i class="fas fa-arrow-right ml-2"></i>
              </a>
            </div>
          </div>
        {% endfor %}
      </div>
      
      <!-- No Results Message -->
      <div id="noResults" class="hidden text-center py-20">
        <div class="w-24 h-24 bg-gray-100 dark:bg-dark-800 rounded-full flex items-center justify-center mx-auto mb-6">
          <i class="fas fa-search text-gray-400 dark:text-gray-500 text-4xl"></i>
        </div>
        <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">No Courses Found</h3>
        <p class="text-gray-600 dark:text-gray-400 mb-6">Try adjusting your search or filter criteria</p>
        <button onclick="clearFilters()" class="inline-flex items-center bg-brand-orange text-white px-6 py-3 rounded-xl font-semibold hover:bg-brand-blue transition shadow-lg">
          <i class="fas fa-redo mr-2"></i>Clear Filters
        </button>
      </div>
    {% else %}
      <div class="text-center py-20">
        <div class="w-24 h-24 bg-gray-100 dark:bg-dark-800 rounded-full flex items-center justify-center mx-auto mb-6">
          <i class="fas fa-book-open text-gray-400 dark:text-gray-500 text-4xl"></i>
        </div>
        <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">No Courses Available Yet</h3>
        <p class="text-gray-600 dark:text-gray-400 mb-6">We're working on adding amazing courses. Check back soon!</p>
        <a href="{% url 'academy_web:home' %}" class="inline-flex items-center bg-brand-orange text-white px-6 py-3 rounded-xl font-semibold hover:bg-brand-blue transition shadow-lg">
          <i class="fas fa-home mr-2"></i>Back to Home
        </a>
      </div>
    {% endif %}
  </div>
</section>

<!-- Why Choose Us Section -->
<section class="py-16 bg-white dark:bg-dark-800">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-12">
      <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">Why Learn With Us?</h2>
      <p class="text-gray-600 dark:text-gray-400">Benefits you get when you enroll in our courses</p>
    </div>
    
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      <div class="text-center p-6">
        <div class="w-16 h-16 bg-brand-orange rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg">
          <i class="fas fa-infinity text-white text-2xl"></i>
        </div>
        <h3 class="font-bold text-gray-900 dark:text-white mb-2">Lifetime Access</h3>
        <p class="text-gray-600 dark:text-gray-400 text-sm">Pay once, learn forever with all future updates included</p>
      </div>
      
      <div class="text-center p-6">
        <div class="w-16 h-16 bg-brand-orange rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg">
          <i class="fas fa-certificate text-white text-2xl"></i>
        </div>
        <h3 class="font-bold text-gray-900 dark:text-white mb-2">Certificates</h3>
        <p class="text-gray-600 dark:text-gray-400 text-sm">Earn certificates to showcase your skills to employers</p>
      </div>
      
      <div class="text-center p-6">
        <div class="w-16 h-16 bg-brand-orange rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg">
          <i class="fas fa-headset text-white text-2xl"></i>
        </div>
        <h3 class="font-bold text-gray-900 dark:text-white mb-2">24/7 Support</h3>
        <p class="text-gray-600 dark:text-gray-400 text-sm">Get help whenever you need it from our support team</p>
      </div>
      
      <div class="text-center p-6">
        <div class="w-16 h-16 bg-brand-orange rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg">
          <i class="fas fa-mobile-alt text-white text-2xl"></i>
        </div>
        <h3 class="font-bold text-gray-900 dark:text-white mb-2">Learn Anywhere</h3>
        <p class="text-gray-600 dark:text-gray-400 text-sm">Access courses on desktop, tablet, or mobile devices</p>
      </div>
    </div>
  </div>
</section>

<!-- CTA Section -->
<section class="py-16 bg-brand-orange">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
    <h2 class="text-3xl font-bold text-white mb-4">Can't Find What You're Looking For?</h2>
    <p class="text-xl text-white/80 mb-8">Let us know what courses you'd like to see, and we'll work on adding them!</p>
    <a href="mailto:support@veeruproacademy.com" class="inline-flex items-center bg-white text-brand-orange px-8 py-4 rounded-xl font-semibold text-lg hover:bg-gray-100 transition shadow-lg">
      <i class="fas fa-envelope mr-2"></i>Request a Course
    </a>
  </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
let activeLevel = '';
let activePrice = '';

function filterCourses() {
  const searchTerm = document.getElementById('courseSearch').value.toLowerCase();
  const cards = document.querySelectorAll('.course-card');
  let visibleCount = 0;
  
  cards.forEach(card => {
    const title = card.dataset.title;
    const description = card.dataset.description;
    const level = card.dataset.level;
    const price = parseFloat(card.dataset.price);
    
    let matchesSearch = title.includes(searchTerm) || description.includes(searchTerm);
    let matchesLevel = !activeLevel || level === activeLevel;
    let matchesPrice = !activePrice || (activePrice === 'free' && price === 0);
    
    if (matchesSearch && matchesLevel && matchesPrice) {
      card.classList.remove('hidden');
      visibleCount++;
    } else {
      card.classList.add('hidden');
    }
  });
  
  document.getElementById('courseCount').textContent = visibleCount;
  document.getElementById('noResults').classList.toggle('hidden', visibleCount > 0);
  document.getElementById('coursesGrid').classList.toggle('hidden', visibleCount === 0);
}

function filterByLevel(level) {
  activeLevel = level;
  activePrice = '';
  updateFilterButtons();
  filterCourses();
}

function filterByPrice(price) {
  activePrice = price;
  activeLevel = '';
  updateFilterButtons();
  filterCourses();
}

function updateFilterButtons() {
  document.querySelectorAll('.filter-btn').forEach(btn => {
    const btnLevel = btn.dataset.level;
    const btnPrice = btn.dataset.price;
    
    const isActive = (btnLevel !== undefined && btnLevel === activeLevel) || 
                     (btnPrice !== undefined && btnPrice === activePrice) ||
                     (btnLevel === '' && !activeLevel && !activePrice);
    
    if (isActive) {
      btn.classList.add('bg-brand-orange/10', 'text-brand-orange');
      btn.classList.remove('bg-gray-100', 'dark:bg-dark-700', 'text-gray-600', 'dark:text-gray-400');
    } else {
      btn.classList.remove('bg-brand-orange/10', 'text-brand-orange');
      btn.classList.add('bg-gray-100', 'dark:bg-dark-700', 'text-gray-600', 'dark:text-gray-400');
    }
  });
}

function clearFilters() {
  activeLevel = '';
  activePrice = '';
  document.getElementById('courseSearch').value = '';
  updateFilterButtons();
  filterCourses();
}
</script>
{% endblock %}
